<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="initial-scale=1, width=device-width" />
  <link rel="stylesheet" href="global.css" />
  <link rel="stylesheet" href="Cart.css" />
  <link rel="stylesheet" href="">
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Inter:ital,wght@0,100;0,400;0,600;0,700;1,600&display=swap" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" />
</head>

<body>

  <div class="cart">

    <div class="cart1">Cart</div>
    <img class="back-icon" alt="" id="back-icon" src="public/chevronleft.svg" />
    <img class="trans-history" alt="" id="trans-history" src="public/trans-history.png" />

    <div class="cart-foodmenusection" id="cart-items">

    </div>

    <div class="bottomsection">
      <div class="total-bill-rs total-price"></div>
      <div class="clear-cart">Clear Cart</div>
      <button class="cart-child">Place Order</button>
    </div>

  </div>

  <script>
    var dish = document.getElementById("back-icon");
    if (dish) {
      dish.addEventListener("click", function (e) {
        window.location.href = "HomePage.html";
      });
    }

    var dish = document.getElementById("trans-history");
    if (dish) {
      dish.addEventListener("click", function (e) {
        window.location.href = "trans-history.html";
      });
    }


    const cartItemsContainer = document.getElementById('cart-items');

    // Render the cart items
    function renderCartItems() {
      const cartItems = JSON.parse(localStorage.getItem('cartItems')) || [];
      cartItemsContainer.innerHTML = '';

      cartItems.forEach((item, index) => {
        const cartItem = document.createElement('div');
        cartItem.innerHTML = `

              
              
              <div class="dish" id="dish">
                <div class="dish-details">
                  <div class="dish-name">${item.name}</div>
                  <div class="dish-price">${item.price}</div>
                  <h3 class="price">${item.price}</h3>

                  <img class="remove-item" alt="" id="remove-item" src="public/bin.png" />
                  <i class="fa-duotone fa-trash" style="--fa-primary-color: #464444; --fa-primary-opacity: 0.6; --fa-secondary-color: #000000; --fa-secondary-opacity: 0.8; data-index="${index}"></i>
                
                </div>
                <button class="b1 minus">-</button>
                <button class="b quantity">1</button>
                <button class="b2 plus">+</button>
              </div>

          `;
        cartItemsContainer.appendChild(cartItem);
      });

      // Remove the old event listeners before attaching new ones
      const removeItemButtons = document.querySelectorAll('.remove-item');
      removeItemButtons.forEach(removeItemButton => {
        const index = removeItemButton.getAttribute('data-index');
        removeItemButton.removeEventListener('click', removeCartItem);
        removeItemButton.addEventListener('click', () => removeCartItem(index));
      });
    }

    // Remove the item at the specified index from the cart and re-render the cart items
    function removeCartItem(index) {
      const cartItems = JSON.parse(localStorage.getItem('cartItems')) || [];
      cartItems.splice(index, 1);
      localStorage.setItem('cartItems', JSON.stringify(cartItems));
      renderCartItems();
    }

    // Add a click event listener to the "Clear Cart" button
    const clearCartButton = document.querySelector('.clear-cart');
    clearCartButton.addEventListener('click', () => {
      // Clear the cart items from local storage
      localStorage.removeItem('cartItems');

      // Remove all the cart items from the container
      cartItemsContainer.innerHTML = '';
    });

    // Call the function to render the cart items
    renderCartItems();


  </script>

  <script src="cart_activity.js"></script>
</body>

</html>
